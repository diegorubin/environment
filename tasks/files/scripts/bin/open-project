#!/usr/bin/env python3

import subprocess
from os import environ, chdir, walk

project_base_dir = "{}/Repos".format(environ.get('HOME'))
chdir(project_base_dir)

projects = []

for root, _dirs, files in walk(project_base_dir):
    for file in files:
        if file == '.nproject':
            projects.append("{}/{}".format(root, file))

print("\n".join(projects))
echo = subprocess.Popen(
    ["echo", "-e", "'\n'".join(projects)], stdout=subprocess.PIPE)
rofi = subprocess.Popen(["rofi", "-dmenu"],
                        stdin=echo.stdout, stdout=subprocess.PIPE)
result = rofi.communicate()[0].decode('utf-8')

if result:
    subprocess.call(result.replace("\n", '').split(' '))
